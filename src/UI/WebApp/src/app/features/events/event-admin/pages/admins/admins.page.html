<div class="page">
    <div class="page-header">
        <h2>Administradores</h2>
        <button class="btn btn-primary" (click)="openInviteModal()">
            + Invitar
        </button>
    </div>

    @if (error()) {
    <div class="alert alert-error">{{ error() }}</div>
    }

    @if (loading()) {
    <div class="loading">Cargando...</div>
    } @else {

    @if (pendingInvitations().length > 0) {
    <div class="section">
        <h3>Invitaciones Pendientes</h3>
        <div class="invitations-list">
            @for (inv of pendingInvitations(); track inv.id) {
            <div class="invitation-card">
                <div class="card-info">
                    <span class="card-email">{{ inv.email }}</span>
                    <span class="card-expires">
                        Expira: {{ inv.expiresAt | date:'dd/MM/yyyy HH:mm' }}
                        @if (inv.isExpired) {
                        <span class="expired-badge">Expirada</span>
                        }
                    </span>
                </div>
            </div>
            }
        </div>
    </div>
    }

    <div class="section">
        <h3>Administradores Activos</h3>
        @if (admins().length === 0) {
        <div class="empty-state">
            <p>No hay administradores adicionales</p>
        </div>
        } @else {
        <div class="admins-list">
            @for (admin of admins(); track admin.id) {
            <div class="admin-card">
                <div class="card-info">
                    <span class="card-name">{{ admin.userName }}</span>
                    <span class="card-email">{{ admin.userEmail }}</span>
                    <span class="card-date">Desde: {{ admin.createdAt | date:'dd/MM/yyyy' }}</span>
                </div>
                <button class="btn-icon delete" title="Eliminar" (click)="removeAdmin(admin)">üóëÔ∏è</button>
            </div>
            }
        </div>
        }
    </div>
    }
</div>

<!-- Invite Modal -->
@if (showInviteModal()) {
<div class="modal-overlay" (click)="closeInviteModal()">
    <div class="modal" (click)="$event.stopPropagation()">
        <div class="modal-header">
            <h3>Invitar Administrador</h3>
            <button class="btn-close" (click)="closeInviteModal()">√ó</button>
        </div>
        <div class="modal-body">
            <div class="form-group">
                <label for="email">Email del usuario</label>
                <input type="email" id="email" [(ngModel)]="inviteEmail" placeholder="usuario@ejemplo.com"
                    [disabled]="inviting()">
            </div>
            <p class="modal-help">
                Se enviar√° una invitaci√≥n por email. El usuario tendr√° 30 minutos para aceptarla.
            </p>
        </div>
        <div class="modal-footer">
            <button class="btn btn-secondary" (click)="closeInviteModal()">Cancelar</button>
            <button class="btn btn-primary" (click)="sendInvitation()" [disabled]="inviting() || !inviteEmail()">
                {{ inviting() ? 'Enviando...' : 'Enviar Invitaci√≥n' }}
            </button>
        </div>
    </div>
</div>
}