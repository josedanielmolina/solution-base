<div class="country-form-container">
    <div class="page-header">
        <a routerLink="/app/admin/countries" class="back-link">← Volver a Países</a>
        <h1>{{ isEditMode() ? 'Editar País' : 'Nuevo País' }}</h1>
    </div>

    @if (loading()) {
    <div class="loading">Cargando...</div>
    } @else {
    @if (errorMessage()) {
    <div class="alert alert-error">{{ errorMessage() }}</div>
    }

    <form [formGroup]="form" (ngSubmit)="submit()" class="form-card">
        <div class="form-group">
            <label for="name">Nombre *</label>
            <input type="text" id="name" formControlName="name" class="form-control">
            @if (form.get('name')?.touched && form.get('name')?.errors) {
            <span class="error-text">
                @if (form.get('name')?.errors?.['required']) { El nombre es requerido }
                @if (form.get('name')?.errors?.['maxlength']) { Máximo 100 caracteres }
            </span>
            }
        </div>

        <div class="form-group">
            <label for="code">Código ISO *</label>
            <input type="text" id="code" formControlName="code" class="form-control" maxlength="3"
                (input)="form.get('code')?.setValue(form.get('code')?.value?.toUpperCase())">
            @if (form.get('code')?.touched && form.get('code')?.errors) {
            <span class="error-text">
                @if (form.get('code')?.errors?.['required']) { El código es requerido }
                @if (form.get('code')?.errors?.['minlength'] || form.get('code')?.errors?.['maxlength']) { Debe tener
                2-3 caracteres }
                @if (form.get('code')?.errors?.['pattern']) { Solo letras mayúsculas }
            </span>
            }
        </div>

        @if (isEditMode()) {
        <div class="form-group">
            <label class="checkbox-label">
                <input type="checkbox" formControlName="isActive">
                <span>Activo</span>
            </label>
        </div>
        }

        <div class="form-actions">
            <a routerLink="/app/admin/countries" class="btn btn-secondary">Cancelar</a>
            <button type="submit" class="btn btn-primary" [disabled]="saving()">
                {{ saving() ? 'Guardando...' : 'Guardar' }}
            </button>
        </div>
    </form>
    }
</div>